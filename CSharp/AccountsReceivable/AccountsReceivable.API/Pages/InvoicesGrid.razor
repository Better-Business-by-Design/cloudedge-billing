@page "/invoicesGrid"

<Breadcrumb Items="_breadcrumb" />

<MudDataGrid 
    T="Document"
    ServerData="@(new Func<GridState<Document>, Task<GridData<Document>>>(GridServerReload))"
    SortMode="SortMode.Multiple"
    Filterable="true"
    QuickFilter="@_quickFilter"
    RowClick="@RowClicked"
    Dense="true"
    >
    <ToolBarContent>
        <MudSpacer />
        <MudTextField @bind-Value="_searchString" Placeholder="Search" Adornment="Adornment.Start" Immediate="true"
            AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
    </ToolBarContent>
    <Columns>
        <PropertyColumn Property="x => x.DateProcessed" Format="dd/MM/yyyy" Title="Date"/>
        <PropertyColumn Property="x => x.KillSheet"/>
        <PropertyColumn Property="x => x.Plant.Name" Title="Plant (Works)"/>
        <PropertyColumn Property="x => x.Farm.Name" Title="Farm"/>
        <PropertyColumn Property="x => x.SpeciesType.DisplayName" Title="Species"/>
        <PropertyColumn Property="x => x.StatusId" Title="Status"/>
    </Columns>
    <PagerContent>
        <MudDataGridPager T="Document" PageSizeOptions="new[] { 20, 40, 80 }"/>
    </PagerContent>
</MudDataGrid>

@* <MudTable Dense="true" Hover="true" *@
@*           ServerData="@(new Func<TableState, Task<TableData<Document>>>(ServerReload))" *@
@*           OnRowClick="RowClickEvent" RowStyleFunc="RowStyleFunc" T="Document" *@
@*           @ref="_table"> *@
@*     <ToolBarContent> *@
@*         <MudSpacer/> *@
@*         <MudTextField T="string" ValueChanged="OnSearch" Placeholder="Search" Adornment="Adornment.Start" *@
@*                       AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"> *@
@*         </MudTextField> *@
@*     </ToolBarContent> *@
@*     <HeaderContent> *@
@*         <MudTh> *@
@*             <MudTableSortLabel SortLabel="date_field" T="Document"> *@
@*                 Date *@
@*             </MudTableSortLabel> *@
@*         </MudTh> *@
@*         <MudTh> *@
@*             <MudTableSortLabel SortLabel="killsheet_field" T="Document"> *@
@*                 KillSheet *@
@*             </MudTableSortLabel> *@
@*         </MudTh> *@
@*         <MudTh> *@
@*             <MudTableSortLabel SortLabel="plant_field" T="Document"> *@
@*                 Plant (Works) *@
@*             </MudTableSortLabel> *@
@*         </MudTh> *@
@*         <MudTh> *@
@*             <MudTableSortLabel SortLabel="farm_field" T="Document"> *@
@*                 Farm *@
@*             </MudTableSortLabel> *@
@*         </MudTh> *@
@*         <MudTh> *@
@*             <MudTableSortLabel SortLabel="species_field" T="Document"> *@
@*                 Species *@
@*             </MudTableSortLabel> *@
@*         </MudTh> *@
@*         <MudTh> *@
@*             <MudTableSortLabel InitialDirection="SortDirection.Ascending" SortLabel="status_field" T="Document"> *@
@*                 Status *@
@*             </MudTableSortLabel> *@
@*         </MudTh> *@
@*     </HeaderContent> *@
@*     <RowTemplate> *@
@*         <MudTd DataLabel="Date"> *@
@*             @context.DateProcessed.ToString("dd/MM/yyyy") *@
@*         </MudTd> *@
@*         <MudTd DataLabel="KillSheet"> *@
@*             @context.KillSheet *@
@*         </MudTd> *@
@*         <MudTd DataLabel="Plant (Works)"> *@
@*             @($"{context.Plant.Name} ({context.Plant.Meatwork.Name})") *@
@*         </MudTd> *@
@*         <MudTd DataLabel="Farm"> *@
@*             @context.Farm.Name *@
@*         </MudTd> *@
@*         <MudTd DataLabel="Species"> *@
@*             @(context.SpeciesType?.DisplayName ?? "Unknown") *@
@*         </MudTd> *@
@*         <MudTd DataLabel="Status"> *@
@*             @context.Status.Name *@
@*         </MudTd> *@
@*     </RowTemplate> *@
@*     <NoRecordsContent> *@
@*         <MudText>No matching Created Invoices found</MudText> *@
@*     </NoRecordsContent> *@
@*     <LoadingContent> *@
@*         <MudText>Loading Buyer Created Invoices...</MudText> *@
@*     </LoadingContent> *@
@*     <PagerContent> *@
@*         <MudTablePager PageSizeOptions="new[] { 20, 40, 80 }"/> *@
@*     </PagerContent> *@
@* </MudTable> *@